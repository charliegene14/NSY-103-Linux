<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NSY103 - DENIER Charlie: Référence du fichier include/managers/ServerPhilosopher.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">NSY103 - DENIER Charlie
   </div>
   <div id="projectbrief">Documentation technique du projet du module NSY103, le problème des philosophes.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Recherche',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_server_philosopher_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Chargement...</div>
<div class="SRStatus" id="Searching">Recherche...</div>
<div class="SRStatus" id="NoMatches">Aucune correspondance</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Fonctions</a>  </div>
  <div class="headertitle"><div class="title">Référence du fichier ServerPhilosopher.c</div></div>
</div><!--header-->
<div class="contents">

<p>Implémente les fonctions de gestion des philosophes côté serveur.  
<a href="#details">Plus de détails...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="maxmin__philosophers_8h_source.html">../maxmin_philosophers.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sockets_8h_source.html">../utils/sockets.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_server_philosopher_8h_source.html">../entities/ServerPhilosopher.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_shared_resources_8h_source.html">../entities/SharedResources.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_chopstick_8c_source.html">../managers/Chopstick.c</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_request_8c_source.html">../managers/Request.c</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_response_8c_source.html">../managers/Response.c</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_logs_8c_source.html">../managers/Logs.c</a>&quot;</code><br />
<code>#include &lt;signal.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;semaphore.h&gt;</code><br />
</div>
<p><a href="_server_philosopher_8c_source.html">Aller au code source de ce fichier.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Fonctions</h2></td></tr>
<tr class="memitem:a59a0430e98c1d9044c4eedf8a94bcb10" id="r_a59a0430e98c1d9044c4eedf8a94bcb10"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_server_philosopher.html">ServerPhilosopher</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a59a0430e98c1d9044c4eedf8a94bcb10">getPhilosopherFromId</a> (int id, <a class="el" href="struct_server_philosopher.html">ServerPhilosopher</a> *philosophers)</td></tr>
<tr class="memdesc:a59a0430e98c1d9044c4eedf8a94bcb10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recherche un philosophe dans le tableau à partir de son identifiant.  <br /></td></tr>
<tr class="separator:a59a0430e98c1d9044c4eedf8a94bcb10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c145e1aa8794f6b7f46723f2befb7f4" id="r_a5c145e1aa8794f6b7f46723f2befb7f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c145e1aa8794f6b7f46723f2befb7f4">definePhilosopherRightChopstick</a> (<a class="el" href="struct_server_philosopher.html">ServerPhilosopher</a> *philosopher, <a class="el" href="struct_shared_resources.html">SharedResources</a> *sharedResources)</td></tr>
<tr class="memdesc:a5c145e1aa8794f6b7f46723f2befb7f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attribue la baguette droite à un nouveau philosophe.  <br /></td></tr>
<tr class="separator:a5c145e1aa8794f6b7f46723f2befb7f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9e50c1de00e8b4aa629038253b67cbc" id="r_af9e50c1de00e8b4aa629038253b67cbc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_server_philosopher.html">ServerPhilosopher</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af9e50c1de00e8b4aa629038253b67cbc">createPhilosopher</a> (<a class="el" href="struct_shared_resources.html">SharedResources</a> *sharedResources)</td></tr>
<tr class="memdesc:af9e50c1de00e8b4aa629038253b67cbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Crée un philosophe côté serveur.  <br /></td></tr>
<tr class="separator:af9e50c1de00e8b4aa629038253b67cbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67648dd0c4f1c2b34fcf0d569a888883" id="r_a67648dd0c4f1c2b34fcf0d569a888883"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_server_philosopher.html">ServerPhilosopher</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a67648dd0c4f1c2b34fcf0d569a888883">updatePhilosopher</a> (<a class="el" href="struct_philosopher.html">Philosopher</a> philosopher, <a class="el" href="struct_shared_resources.html">SharedResources</a> *sharedResources)</td></tr>
<tr class="memdesc:a67648dd0c4f1c2b34fcf0d569a888883"><td class="mdescLeft">&#160;</td><td class="mdescRight">Met à jour l'état d'un philosophe côté serveur.  <br /></td></tr>
<tr class="separator:a67648dd0c4f1c2b34fcf0d569a888883"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description détaillée</h2>
<div class="textblock"><p>Implémente les fonctions de gestion des philosophes côté serveur. </p>
<p>Ce fichier d'implémentation contient les fonctions permettant de gérer les philosophes côté serveur. Il inclut la recherche d'un philosophe à partir de son identifiant, l'attribution des baguettes (à gauche et à droite) lors de la création d'un nouveau philosophe, ainsi que la mise à jour de l'état des philosophes (gestion des transitions entre THINKING, HUNGRY et EATING).</p>
<p>Les fonctions implémentées dans ce fichier sont :</p><ul>
<li><b>getPhilosopherFromId</b> : Recherche un philosophe dans le tableau à partir de son identifiant.</li>
<li><b>definePhilosopherRightChopstick</b> : Attribue la baguette droite pour un nouveau philosophe, en réattribuant la baguette de l'avant-dernier philosophe si nécessaire.</li>
<li><b>createPhilosopher</b> : Crée et initialise un philosophe côté serveur, attribue sa baguette gauche et, pour les philosophes ultérieurs, la baguette droite via la fonction dédiée. Met également à jour le compteur limitant le nombre de philosophes pouvant manger simultanément.</li>
<li><b>updatePhilosopher</b> : Met à jour l'état d'un philosophe existant en gérant la libération ou l'acquisition des baguettes en fonction de son nouvel état, et synchronise l'accès au compteur global.</li>
</ul>
<p>Ce module utilise les mécanismes IPC (sémaphores et files de messages) pour synchroniser l'accès aux ressources partagées.</p>
<dl class="section note"><dt>Note</dt><dd>L'inclusion de divers fichiers d'entités et de gestion (<a class="el" href="struct_chopstick.html" title="Structure représentant une baguette.">Chopstick</a>, <a class="el" href="struct_shared_resources.html" title="Structure regroupant les ressources partagées du serveur.">SharedResources</a>, <a class="el" href="struct_request.html" title="Structure représentant une requête adressée au serveur.">Request</a>, <a class="el" href="struct_response.html" title="Structure représentant une réponse envoyée par le serveur.">Response</a>, Logs) permet d'assurer une cohérence dans la gestion des ressources et des communications côté serveur. </dd></dl>
</div><h2 class="groupheader">Documentation des fonctions</h2>
<a id="af9e50c1de00e8b4aa629038253b67cbc" name="af9e50c1de00e8b4aa629038253b67cbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9e50c1de00e8b4aa629038253b67cbc">&#9670;&#160;</a></span>createPhilosopher()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_server_philosopher.html">ServerPhilosopher</a> createPhilosopher </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_shared_resources.html">SharedResources</a> *</td>          <td class="paramname"><span class="paramname"><em>sharedResources</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Crée un philosophe côté serveur. </p>
<p>Cette fonction synchronise la création d'un nouveau philosophe grâce à un sémaphore, initialise le philosophe, attribue sa baguette gauche via la fonction createChopstick, et, si ce n'est pas le premier philosophe, définit sa baguette droite en appelant definePhilosopherRightChopstick. Le philosophe est ensuite ajouté à la mémoire partagée, et le compteur de philosophes est incrémenté. Si le nombre total de philosophes devient pair, le compteur de philosophes pouvant manger est incrémenté.</p>
<dl class="params"><dt>Paramètres</dt><dd>
  <table class="params">
    <tr><td class="paramname">sharedResources</td><td>Pointeur vers la structure des ressources partagées. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Renvoie</dt><dd><a class="el" href="struct_server_philosopher.html" title="Structure représentant un philosophe côté serveur.">ServerPhilosopher</a> Le philosophe créé et ajouté aux ressources partagées. </dd></dl>

</div>
</div>
<a id="a5c145e1aa8794f6b7f46723f2befb7f4" name="a5c145e1aa8794f6b7f46723f2befb7f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c145e1aa8794f6b7f46723f2befb7f4">&#9670;&#160;</a></span>definePhilosopherRightChopstick()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void definePhilosopherRightChopstick </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_server_philosopher.html">ServerPhilosopher</a> *</td>          <td class="paramname"><span class="paramname"><em>philosopher</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_shared_resources.html">SharedResources</a> *</td>          <td class="paramname"><span class="paramname"><em>sharedResources</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Attribue la baguette droite à un nouveau philosophe. </p>
<p>Cette fonction, de nature bloquante, gère l'attribution de la baguette droite pour un philosophe nouvellement créé. Pour le premier philosophe, aucune attribution n'est faite. Pour les philosophes suivants, la première baguette est assignée à droite du nouveau philosophe. De plus, pour le deuxième philosophe, la baguette gauche du nouveau philosophe est affectée à droite du premier. Pour les philosophes suivants, la fonction réattribue la baguette droite de l'avant-dernier philosophe à la nouvelle baguette créée, en s'assurant d'une synchronisation via un sémaphore.</p>
<dl class="params"><dt>Paramètres</dt><dd>
  <table class="params">
    <tr><td class="paramname">philosopher</td><td>Pointeur vers le philosophe dont la baguette droite doit être définie. </td></tr>
    <tr><td class="paramname">sharedResources</td><td>Pointeur vers les ressources partagées contenant les baguettes et les philosophes. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a59a0430e98c1d9044c4eedf8a94bcb10" name="a59a0430e98c1d9044c4eedf8a94bcb10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59a0430e98c1d9044c4eedf8a94bcb10">&#9670;&#160;</a></span>getPhilosopherFromId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_server_philosopher.html">ServerPhilosopher</a> * getPhilosopherFromId </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_server_philosopher.html">ServerPhilosopher</a> *</td>          <td class="paramname"><span class="paramname"><em>philosophers</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Recherche un philosophe dans le tableau à partir de son identifiant. </p>
<p>Cette fonction parcourt le tableau des philosophes côté serveur et retourne un pointeur vers le philosophe dont l'identifiant correspond à celui passé en paramètre.</p>
<dl class="params"><dt>Paramètres</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>L'identifiant du philosophe recherché. </td></tr>
    <tr><td class="paramname">philosophers</td><td>Tableau des philosophes côté serveur. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Renvoie</dt><dd>ServerPhilosopher* Pointeur vers le philosophe correspondant ou NULL s'il n'est pas trouvé. </dd></dl>

</div>
</div>
<a id="a67648dd0c4f1c2b34fcf0d569a888883" name="a67648dd0c4f1c2b34fcf0d569a888883"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67648dd0c4f1c2b34fcf0d569a888883">&#9670;&#160;</a></span>updatePhilosopher()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_server_philosopher.html">ServerPhilosopher</a> * updatePhilosopher </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_philosopher.html">Philosopher</a></td>          <td class="paramname"><span class="paramname"><em>philosopher</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_shared_resources.html">SharedResources</a> *</td>          <td class="paramname"><span class="paramname"><em>sharedResources</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Met à jour l'état d'un philosophe côté serveur. </p>
<p>Cette fonction met à jour la structure d'un philosophe existant dans la mémoire partagée en fonction du nouvel état (THINKING, EATING ou HUNGRY) reçu. En cas de transition de EATING à THINKING, elle libère les baguettes associées et incrémente le compteur principal. Pour l'état HUNGRY, la fonction tente d'acquérir les ressources nécessaires (baguettes et compteur) en tentant d'accéder aux sémaphores en deux fois: d'abord en non-bloquant, pour logguer l'attente si besoin, puis on bloque.</p>
<dl class="params"><dt>Paramètres</dt><dd>
  <table class="params">
    <tr><td class="paramname">philosopher</td><td>La structure <code><a class="el" href="struct_philosopher.html" title="Structure représentant la base d&#39;un philosophe.">Philosopher</a></code> contenant le nouvel état du philosophe. </td></tr>
    <tr><td class="paramname">serviceSocket</td><td><a class="el" href="struct_socket.html" title="Structure représentant une socket.">Socket</a> de service associé (non utilisé directement dans cette fonction). </td></tr>
    <tr><td class="paramname">sharedResources</td><td>Pointeur vers la structure des ressources partagées. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Renvoie</dt><dd>ServerPhilosopher* Pointeur vers le philosophe mis à jour si une réponse doit être renvoyée au client, ou NULL si aucune mise à jour à notifier n'est nécessaire. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_3b632b175d4850e946ee3ba45d8d1f8d.html">managers</a></li><li class="navelem"><a class="el" href="_server_philosopher_8c.html">ServerPhilosopher.c</a></li>
    <li class="footer">Généré par <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
